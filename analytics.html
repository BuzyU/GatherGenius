<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#ff6600">
    <title>Analytics - GatherGenius</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <!-- Theme Manager - Load first to prevent flash -->
    
</head>
<body>
    <div class="dashboard-container">
        <!-- Mobile Menu Toggle -->
        <button class="mobile-menu-toggle" id="mobile-menu-toggle">
            <i class="fas fa-bars"></i>
        </button>
        
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="gatherlogo.jpeg" alt="GatherGenius" class="logo">
                <button class="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            <nav class="sidebar-nav">
                <a href="dashboard.html" class="nav-item">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                </a>
                <a href="events.html" class="nav-item">
                    <i class="fas fa-calendar-alt"></i>
                    <span>Events</span>
                </a>
                <a href="teams.html" class="nav-item">
                    <i class="fas fa-users"></i>
                    <span>Teams</span>
                </a>
                <a href="analytics.html" class="nav-item active">
                    <i class="fas fa-chart-bar"></i>
                    <span>Analytics</span>
                </a>
                <a href="settings.html" class="nav-item">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </a>
            </nav>
            <button id="logout-btn" class="logout-btn">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </button>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="content-header">
                <div class="header-left">
                    <h1>Analytics & Reports</h1>
                </div>
                <div class="header-right">
                    <div class="filter-group">
                        <select id="timeFilter" onchange="applyTimeFilter()">
                            <option value="all">All Time</option>
                            <option value="7">Last 7 Days</option>
                            <option value="30" selected>Last 30 Days</option>
                            <option value="90">Last 90 Days</option>
                            <option value="365">Last Year</option>
                        </select>
                    </div>
                    <button class="btn-primary" onclick="exportReport()">
                        <i class="fas fa-download"></i> Export Report
                    </button>
                    <div class="user-menu">
                        <button class="user-menu-btn">
                            <img id="user-avatar" src="https://ui-avatars.com/api/?background=0D8ABC&color=fff" alt="User">
                            <span id="user-name">Guest</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="user-dropdown">
                            <a href="profile.html" class="dropdown-item">
                                <i class="fas fa-user"></i>
                                Profile
                            </a>
                            <a href="settings.html" class="dropdown-item">
                                <i class="fas fa-cog"></i>
                                Settings
                            </a>
                            <div class="dropdown-divider"></div>
                            <a href="#" class="dropdown-item text-danger" id="logout-link">
                                <i class="fas fa-sign-out-alt"></i>
                                Logout
                            </a>
                        </div>
                    </div>
                </div>
            </header>

            <div class="analytics-content">
                <!-- Overview Stats -->
                <div class="stats-grid analytics-stats">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(23, 162, 184, 0.1); color: #17a2b8;">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Total Events</h3>
                            <p id="total-events-stat">0</p>
                            <small class="stat-change positive" id="events-change">+0% from last period</small>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(40, 167, 69, 0.1); color: #28a745;">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Total Participants</h3>
                            <p id="total-participants-stat">0</p>
                            <small class="stat-change positive" id="participants-change">+0% from last period</small>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(255, 193, 7, 0.1); color: #ffc107;">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Avg Participation</h3>
                            <p id="avg-participation-stat">0</p>
                            <small class="stat-change" id="participation-change">per event</small>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(220, 53, 69, 0.1); color: #dc3545;">
                            <i class="fas fa-rupee-sign"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Total Revenue</h3>
                            <p id="total-revenue-stat">â‚¹0</p>
                            <small class="stat-change positive" id="revenue-change">+0% from last period</small>
                        </div>
                    </div>
                </div>

                <!-- Charts Row 1 -->
                <div class="charts-row">
                    <div class="chart-container">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-line"></i> Events Timeline</h3>
                        </div>
                        <canvas id="eventsTimelineChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-pie"></i> Events by Category</h3>
                        </div>
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>

                <!-- Charts Row 2 -->
                <div class="charts-row">
                    <div class="chart-container">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-bar"></i> Participation Trends</h3>
                        </div>
                        <canvas id="participationChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <div class="chart-header">
                            <h3><i class="fas fa-calendar-alt"></i> Event Status Distribution</h3>
                        </div>
                        <canvas id="statusChart"></canvas>
                    </div>
                </div>

                <!-- Charts Row 3 -->
                <div class="charts-row">
                    <div class="chart-container full-width">
                        <div class="chart-header">
                            <h3><i class="fas fa-money-bill-wave"></i> Revenue Analysis</h3>
                        </div>
                        <canvas id="revenueChart"></canvas>
                    </div>
                </div>

                <!-- Top Events Table -->
                <div class="analytics-section">
                    <div class="section-header">
                        <h2><i class="fas fa-trophy"></i> Top Performing Events</h2>
                    </div>
                    <div class="table-container">
                        <table class="analytics-table">
                            <thead>
                                <tr>
                                    <th>Event Name</th>
                                    <th>Category</th>
                                    <th>Participants</th>
                                    <th>Revenue</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="topEventsTable">
                                <tr>
                                    <td colspan="6" class="loading-placeholder">Loading data...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Category Performance -->
                <div class="analytics-section">
                    <div class="section-header">
                        <h2><i class="fas fa-layer-group"></i> Category Performance</h2>
                    </div>
                    <div id="categoryPerformance" class="category-performance-grid">
                        <!-- Category cards will be populated here -->
                    </div>
                </div>

                <!-- Insights Section -->
                <div class="analytics-section">
                    <div class="section-header">
                        <h2><i class="fas fa-lightbulb"></i> Key Insights</h2>
                    </div>
                    <div id="insightsContainer" class="insights-container">
                        <!-- Insights will be populated here -->
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="analytics.js"></script>
</body>
</html>